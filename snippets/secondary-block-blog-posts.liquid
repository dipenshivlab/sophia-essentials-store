{% include 'settings' %}

{%- assign sb_blog = blogs[block.settings.blog] -%}

{% comment %}
  Article list
{% endcomment %}
{% if sb_blog != empty %}
  <div class="blog-articles">
    {% for article in sb_blog.articles limit: block.settings.article_limit %}

    {% comment %}
      Hide the tags section if none are assigned
    {% endcomment %}
    {%- assign show_tags = section.settings.show_tags -%}
    {% if article.tags.size < 1 %}
      {%- assign show_tags = false -%}
    {% endif %}

    {% comment %}
      Separator
    {% endcomment %}
    {% unless forloop.first %}
      {% include 'separator' class:'margin-top-50 margin-bottom-50' %}
    {% endunless %}

    <article class="blog-article">

      {% comment %}
        Article image
      {% endcomment %}
      {% if block.settings.show_image and article.image %}
        <div class="image-frame">
          {% include 'image' with article.image, image_link_url: article.url %}
        </div>

        {% comment %}
          Separator
        {% endcomment %}
        {% include 'separator' class: 'no-margin-top' %}
      {% endif %}


      {% comment %}
        Article header
      {% endcomment %}
      <header>
        <h1 class="title no-margin">
          {{ article.title | escape | link_to: article.url }}
        </h1>
      </header>

      {% comment %}
        Article meta
      {% endcomment %}
      {% if block.settings.show_publish_date or block.settings.show_author or block.settings.show_comment_count %}
        {% include 'separator' class:'margin-top-25 no-margin-bottom' %}
        {% include 'article-meta' class: 'text-left text-light font-size-13 lht', current_blog: sb_blog, show_publish_date: block.settings.show_publish_date, show_author: block.settings.show_author, show_comment_count: block.settings.show_comment_count %}
        {% include 'separator' class: 'no-margin-top margin-bottom-50' %}
      {% else %}
        {% include 'separator' class: 'no-margin-top margin-bottom-25' %}
      {% endif %}

      {% comment %}
        Article excerpt
      {% endcomment %}
      <div class="body">
        {{ article.excerpt_or_content }}
      </div>

      {% comment %}
        Separator
      {% endcomment %}
      {% if block.settings.show_article_link %}
        {% include 'separator' class:'lined margin-top margin-bottom' %}
      {% endif %}

      {% comment %}
        Article link
      {% endcomment %}
      {% if block.settings.show_article_link %}
        <p class="article-link no-margin text-center">
          <a href="{{ article.url }}">{{ 'blog.article_list.go_to_article' | t }}</a>
        </p>
      {% endif %}

      {% comment %}
        JSON-LD structured data
      {% endcomment %}
      {% include 'json-ld-article' %}

    </article>

    {% endfor %}
  </div>
{% else %}
  <div class="no-content">
    <p class="no-margin">{{ 'onboarding.select_blog' | t }}</p>
  </div>
{% endif %}
