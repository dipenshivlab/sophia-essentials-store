{% include 'settings' %}
{% render 'section-open', section: section, type: 'rich-text', title: false %}

{% comment %}
  Section
{% endcomment %}
{%- render 'separator' section_type: 'rich-text', show_title: true %}

{% comment %}
  Blocks
{% endcomment %}
{% if section.blocks.size > 0 %}

  {% for block in section.blocks %}

  {% render 'block-open', section: section, block: block %}

    {% comment %}
      CSS
    {% endcomment %}
    <style>
      #{{ block_id }} .section-block-header-heading,
      #{{ block_id }} .rte {
        {% if block.settings.color %}
          color: {{ block.settings.color }};
        {% endif %}

        text-align: {{ block.settings.alignment }};
      }

    </style>

    {% comment %}
      Text block
    {% endcomment %}
    {% if block.type == 'text' %}

      <span class="rte">
        {{ block.settings.text }}
      </span>

    {% comment %}
      Page block
    {% endcomment %}
    {% elsif block.type == 'page' %}
      {%- assign block_page = pages[block.settings.page] -%}
      {% if block_page != empty %}
        <span class="rte">
          {{ block_page.content }}
        </span>
      {% else %}
        <div class="no-content">
          <p class="no-margin">{{ 'onboarding.select_page' | t }}</p>
        </div>
      {% endif %}
    {% endif %}

    {% render 'block-close' %}

    {% unless forloop.last %}
      {% render 'separator', class: 'margin-top-50 margin-bottom' %}
    {% endunless %}

  {% endfor %}

{% else %}

  {% render 'no-blocks' %}

{% endif %}

{% include 'section-close' %}


{% comment %}
  Schema
{% endcomment %}
{% schema %}
{
  "name": "Rich text",
  "class": "index-section section-rich-text",
  "max_blocks": 2,
  "settings": [
    {
      "id": "width",
      "type": "select",
      "label": "Width",
      "options": [
        {"value": "column-max", "label": "Content"},
        {"value": "width-100", "label": "Screen"}
      ],
      "default": "column-max"
    }
  ],
  "blocks": [
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "id": "title",
          "type": "text",
          "label": "Heading",
          "default": "Talk about your brand"
        },
        {
          "id": "text",
          "type": "richtext",
          "label": "Text",
          "default": "<p>Use this text to share information about your brand with your customers. Describe a product, share announcements, or welcome customers to your store.</p>"
        },
        {
          "id": "alignment",
          "type": "select",
          "label": "Alignment",
          "options": [
            {"value": "left", "label": "Left"},
            {"value": "center", "label": "Center"},
            {"value": "right", "label": "Right"}
          ],
          "default": "left"
        },
        {
          "id": "color",
          "type": "color",
          "label": "Color",
          "default": "#2a2b2b"
        }
      ]
    },
    {
      "type": "page",
      "name": "Page",
      "settings": [
        {
          "id": "title",
          "type": "text",
          "label": "Heading"
        },
        {
          "id": "page",
          "type": "page",
          "label": "Page content"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Rich text",
      "category": "Text",
      "settings": {
      },
      "blocks": [
        {
          "type": "text"
        }
      ]
    }
  ]
}
{% endschema %}
